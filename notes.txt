should probably remove the 'continue's, they do nothing.